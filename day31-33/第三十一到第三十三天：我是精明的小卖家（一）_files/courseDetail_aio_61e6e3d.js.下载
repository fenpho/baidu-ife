define("course/courseDetail",["require","exports","module","babelHelpers","jquery","../common/biz/page","../common/resource","../common/ui/Modal","../common/ui/LoadMore","../common/biz/WorkSubmitDialog","../common/util","../common/util/url","../common/biz/reviewApply","../common/biz/NoteSubmitDialog","../common/services/user"],function(e,t){function o(e,t,o){return e.button("loading"),p.default.post("/course/updateLearnStatus",{courseId:o.courseId,status:t}).then(function(t){0===t.status?window.location.replace(I.updateURL(window.location.href,{t:(new Date).getTime()},"learn")):(e.button("reset"),h.default.alert(t.statusInfo||"变更学习状态失败"))},function(){e.button("reset")})}function n(e){var t=d.default.extend({courseId:e.courseId},e.workInfo),o=new k.default(t);o.show()}function r(e){var t=d.default(".start-learn-btn, .relearn-btn");t.on("click",d.default.proxy(o,this,t,1,e));var r=d.default(".giveup-learn-btn");r.on("click",d.default.proxy(o,this,r,3,e)),d.default(".submit-work-btn").on("click",d.default.proxy(n,this,e)),d.default(".apply-review-btn").on("click",function(){q.default(d.default(this),e.workInfo.workId,function(){var e=d.default(".apply-review-tip"),t=d.default(".apply-count",e),o=parseInt(t.text(),10);t.text(o+1);var n=d.default(".remain-count",e);o=parseInt(n.text(),10),d.default(".remain-count",e).text(o-1)})}),d.default(".my-note-info").on("click",".create-note-btn",function(){var t=new z.default({courseId:e.courseId,courseTitle:e.courseTitle});t.show()}).on("click",".edit-note-btn",function(){var e=new z.default({id:d.default(this).data("note")});e.then(function(e){e&&e.show()})}).on("click",".del-note-btn",function(){var e=d.default(this);h.default.confirm("确认删除该笔记?",function(){e.button("loading"),R.delUserNote(e.data("note")).then(function(t){e.button("reset"),t.hasError?h.default.alert(t.errorInfo):window.location.reload()})})})}function a(e,t){for(var o=0,n=t.length;n>o;o++){var r=D.encodeData(t[o]),a='<span class="none-tip">无</span>';r.demoUrl&&(a='<a href="'+r.demoUrl+'" target="_blank">点击查看</a>');var u='<span class="none-tip">0</span>',i='<span class="none-tip">-</span>';+r.reviewNum&&(u=r.reviewNum,i=r.avgScore),e.append('\n            <tr><td class="submitter"><a href="'+r.userProfile+'"><img class="user-photo" src="'+r.userPhoto+'">'+r.userName+"</a></td>\n            <td>"+r.submitTime+'</td>\n            <td><a href="'+r.codeUrl+'" target="_blank">点击查看</a></td>\n            <td>'+a+"</td>\n            <td>"+u+"</td>\n            <td>"+i+'</td>\n            <td><a href="'+r.detailUrl+'">去评价获取积分</a></td></tr>\n        ')}}function u(e){var t=d.default(".others-work-info");if(t.length){var o=d.default(".work-empty-tip",t),n=new w.default({threshold:!1,target:t,pageNo:0,loadMoreStyle:"view-more",loadData:function(n){return p.default.post("/course/getDoneWorks",{pageNo:n,pageSize:10,courseId:e.courseId}).then(function(e){if(0!==e.status)return{hasError:!0,errorInfo:e.statusInfo};var n=e.data;return+n.total?(d.default(".count",t).text(n.total),a(d.default("tbody",t),n.listData)):o.show(),n})}}).enable();n.fireLoadMore()}}function i(e,t){f.default(e,!0),r(t),u(t)}var l=e("babelHelpers");Object.defineProperty(t,"__esModule",{value:!0}),t.init=i;var c=e("jquery"),d=l.interopRequireDefault(c),s=e("../common/biz/page"),f=l.interopRequireDefault(s),m=e("../common/resource"),p=l.interopRequireDefault(m),b=e("../common/ui/Modal"),h=l.interopRequireDefault(b),v=e("../common/ui/LoadMore"),w=l.interopRequireDefault(v),g=e("../common/biz/WorkSubmitDialog"),k=l.interopRequireDefault(g),D=e("../common/util"),I=e("../common/util/url"),y=e("../common/biz/reviewApply"),q=l.interopRequireDefault(y),x=e("../common/biz/NoteSubmitDialog"),z=l.interopRequireDefault(x),R=e("../common/services/user")});
define("common/biz/page",["require","exports","module","babelHelpers","jquery","../services/message","bootstrap/collapse","bootstrap/dropdown","./eventCenter"],function(e,t){function o(e){var t=i.default(window).scrollTop()>100;e[t?"fadeIn":"fadeOut"]()}function n(e){var t="("+e+")";p.text(t);var o=i.default(".nav-user-pic");if(o.length>0&&e>0){var n='<span class="user-pic-message-tip">'+e+"</span>";o.html(n)}else i.default(".user-pic-message-tip").remove()}function a(){p=i.default("#header-msg-count"),!p.length>0||(c.fetchUnReadMsgCount().then(function(e){e.hasError||n(e.total)}),f.default.on("msgCount",function(e){n(e)}))}function r(){var e=i.default("#go-top");e.on("click",function(){return i.default(document.body).stop().animate({scrollTop:0},200)}),i.default(window).on("scroll",i.default.proxy(o,this,e)),o(e)}function s(e,t){a(),t&&r()}var u=e("babelHelpers");Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var l=e("jquery"),i=u.interopRequireDefault(l),c=e("../services/message");e("bootstrap/collapse"),e("bootstrap/dropdown");var d=e("./eventCenter"),f=u.interopRequireDefault(d),p=void 0});
define("common/resource",["require","exports","module","babelHelpers","jquery"],function(e,t){function n(e,t,n,r){var u=i.default.extend({},r||{});return t&&(u.method=t),u.jsonp===!0&&(u.jsonp="callback"),i.default.ajax(e,i.default.extend(u,{data:n}))}function r(e,t,r){return n(e,"GET",t,r)}function u(e,t,n){return r(e,t,i.default.extend({},n||{},{dataType:"json"}))}function o(e,t,r){return n(e,"POST",t,r)}function a(e,t,r){return n(e,"GET",t,i.default.extend({},r||{},{dataType:"jsonp"}))}function d(e,t,r){var u=i.default.extend({},r||{},{dataType:"text"});return n(e,u.method,t,u)}function l(e,t,r){var u=i.default.extend({},r||{},{dataType:"html"});return n(e,u.method,t,u)}function f(e){e.prototype.$http=n}var p=e("babelHelpers");Object.defineProperty(t,"__esModule",{value:!0}),t.get=r,t.getJSON=u,t.post=o,t.jsonp=a,t.text=d,t.html=l,t.hook=f;var c=e("jquery"),i=p.interopRequireDefault(c);n.get=r,n.getJSON=u,n.post=o,n.jsonp=a,n.text=d,n.html=l,t.default=n});
define("common/ui/Modal",["require","exports","module","babelHelpers","bootstrap/modal","bootstrap/button","jquery","../util"],function(t,o){function n(t){var o=t.saveBtn,n=void 0===o?"保存":o,e=t.closeBtn,a=void 0===e?"关闭":e,s=t.modalBody,i=void 0===s?"":s,l=t.modalTitle,d=void 0===l?"":l,u=t.modalClass,r=void 0===u?"":u,c=t.modalSizeClass,v=void 0===c?"":c,h=t.loadingText,m=void 0===h?"提交中...":h,f=t.footer,b=void 0===f?"":f,p=b;return p||(a!==!1&&(p+='\n            <button type="button" class="btn-close btn btn-default" data-dismiss="modal">'+a+"</button>\n        "),n!==!1&&(p+='<button type="button" class="btn-save ife-primary-btn btn" data-loading-text="'+m+'">'+n+"</button>")),p&&(p='<div class="modal-footer">'+p+"</div>"),r&&(r=" "+r),v&&(v=" "+v),'\n        <div class="modal fade ife-modal'+r+'" role="dialog">\n            <div class="modal-dialog'+v+'" role="document">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <i class="icon-remove"></i>\n                        </button>\n                        <h4 class="modal-title">'+d+'</h4>\n                    </div>\n                    <div class="modal-body">\n                        '+i+"\n                    </div>\n                    "+p+"\n                </div>\n            </div>\n        </div>\n    "}var e=t("babelHelpers");Object.defineProperty(o,"__esModule",{value:!0}),t("bootstrap/modal"),t("bootstrap/button");var a=t("jquery"),s=e.interopRequireDefault(a),i=t("../util"),l="modal-open",d=function(){function t(o){e.classCallCheck(this,t);var a=s.default(n(o));a.appendTo(document.body),this.main=a,this.saveBtn=this.$(".btn-save"),this.options=o,a.modal({backdrop:o.clickMaskClose?!0:"static",show:!1}),this.bindEvents()}return e.createClass(t,[{key:"$",value:function(t){return s.default(t,this.main)}},{key:"onClose",value:function(){var t=this.options.onClose;t&&t.call(this)}},{key:"onShow",value:function(){var t=this.options.onShow;t&&t.call(this)}},{key:"onSave",value:function(){var t=this,o=this.options,n=o.onSave;if(n){var e=n.apply(this,arguments);e&&e.then&&this.saveBtn.button("loading");var a=function(){return t.resetSaveState()};e&&e.then&&e.then(a,a)}}},{key:"resetSaveState",value:function(){this.saveBtn&&this.saveBtn.button("reset")}},{key:"bindEvents",value:function(){var t=this.saveBtn;t.on("click",s.default.proxy(this.onSave,this)),this.main.on("shown.bs.modal",s.default.proxy(this.onShow,this)),this.main.on("hidden.bs.modal",s.default.proxy(this.onClose,this))}},{key:"show",value:function(){this.main.modal("show")}},{key:"hide",value:function(){this.main.modal("hide")}},{key:"dispose",value:function(){this.hide(),this.saveBtn.off("click"),this.main.off(),this.main.remove(),this.main=null}}]),t}(),u="百度前端技术学院";d.confirm=function(t,o,n){2===arguments.length&&(n=o,o=t,t="");var e=s.default(document.body).hasClass(l),a=null,r=0;return e&&(a=s.default(s.default(".modal-backdrop")[0]),r=a.css("z-index"),a.css("z-index",1050)),new d({modalTitle:i.encodeHTML(t||u),modalBody:o,saveBtn:"确定",closeBtn:"取消",onClose:function(){this.dispose(),e&&(a.css("z-index",r),s.default(document.body).addClass(l))},onSave:function(){return this.hide(),n.apply(this,arguments)}}).show()},d.alert=function(t,o){1===arguments.length&&(o=t,t="");var n=s.default(document.body).hasClass(l);return new d({modalTitle:i.encodeHTML(t||u),modalBody:o,saveBtn:!1,closeBtn:"关闭",onClose:function(){this.dispose(),n&&s.default(document.body).addClass(l)}}).show()},o.default=d});
define("common/ui/LoadMore",["require","exports","module","babelHelpers","jquery","saber-emitter"],function(e,t){function o(){return window.pageYOffset}function i(){return v?m.scrollTop:b.scrollTop}function r(e){return x()+window.innerHeight<m.scrollHeight-(e||0)}function s(){!this.hasMore||this._loading||r(this.threshold)||this.fireLoadMore()}function a(){l(this,!1,this.hasMore),this.hasMore||this.disable()}function n(){this._loading||this.fireLoadMore()}function l(e,t,o){var i=e.trigger;i&&(i[t?"addClass":"removeClass"](M),i[o?"removeClass":"addClass"](p)),e._loading=!!t}function h(e){var t=e.loadingText,o=void 0===t?"加载中...":t,i=e.loadMoreNoneText,r=void 0===i?"没有更多了！":i,s=e.loadMoreText,a=void 0===s?"点击加载更多":s,n=e.loadingIcon,l=void 0===n?"icon-loading":n,h=e.loadMoreStyle,d=void 0===h?"":h;d&&(d=" "+d),this.loadMoreText=a;var u="div";return"ul"===this.target[0].tagName.toLowerCase()&&(u="li"),f.default("\n    <"+u+' class="load-more-wrap'+d+'">\n        <div class="loading-tip"><i class="'+l+'"></i>'+o+'</div>\n        <p class="load-none-tip">'+r+'</p>\n        <span class="load-more-btn">'+a+"</span>\n    </"+u+">\n    ")}var d=e("babelHelpers");Object.defineProperty(t,"__esModule",{value:!0});var u=e("jquery"),f=d.interopRequireDefault(u),c=e("saber-emitter"),g=d.interopRequireDefault(c),M="loading",p="load-none-more",v="CSS1Compat"===document.compatMode,m=document.documentElement,b=document.body,x=void 0!==window.pageYOffset?o:i,w=function(){function e(t){d.classCallCheck(this,e),this.rawOpts=f.default.extend({},{hasMore:!0,threshold:0,pageNo:1},t),f.default.extend(this,this.rawOpts),g.default.mixin(this),this.threshold===!0&&(this.threshold=0),this._onscroll=f.default.proxy(s,this),this.on("done",f.default.proxy(a,this)),!this.trigger&&this.target&&(this.target=f.default(this.target),this.trigger=h.call(this,t),this.trigger.appendTo(this.target)),this.trigger&&(this.trigger=f.default(this.trigger),this.loadMoreBtn=f.default(".load-more-btn",this.trigger),this.hasMore&&(this._loadMore=f.default.proxy(n,this)),l(this,!1,this.hasMore))}return d.createClass(e,[{key:"setLoadMoreText",value:function(e){this.loadMoreText=e,this.loadMoreBtn.text(e)}},{key:"reload",value:function(e){this.pageNo=null==e?this.rawOpts.pageNo:e,this.hasMore=!0,this.enable(),this.fireLoadMore()}},{key:"enable",value:function(){if(this._enabled)return this;this._enabled=!0,this.threshold!==!1&&window.addEventListener("scroll",this._onscroll,!1);var e=this.trigger;return e&&e.on("click",this._loadMore),this}},{key:"disable",value:function(){this.threshold!==!1&&window.removeEventListener("scroll",this._onscroll,!1);var e=this.trigger;return e&&e.off("click",this._loadMore),this._enabled=!1,this}},{key:"fireLoadMore",value:function(){var e=this;if(l(this,!0,this.hasMore),this.emit("more",this.pageNo+1),this.loadData){var t=this.loadData.call(this,this.pageNo+1);t&&t.then&&t.then(function(t){if(t||(t={}),t.hasError)e.fireLoadDone({hasMore:!0,hasError:!0,errorInfo:t.errorInfo});else{e.pageNo+=1;var o=t.hasMore;null==o&&t.total&&t.pageSize&&(o=Math.ceil(t.total/t.pageSize)>e.pageNo),e.fireLoadDone({hasMore:o})}},function(){return e.fireLoadDone({hasMore:!0})})}return this}},{key:"fireLoadDone",value:function(e){e||(e={}),this.hasMore=!!e.hasMore,this.loadMoreBtn.text(e.errorInfo?e.errorInfo:this.loadMoreText),this.hasMore||this.emit("nonemore"),this.loadMoreBtn[e.hasError?"addClass":"removeClass"]("load-error"),this.emit("done")}},{key:"dispose",value:function(){this.disable(),this.trigger=null,this.target=null,this.loadMoreBtn=null,this.off("more"),this.off("done")}}]),e}();t.default=w});
define("common/biz/WorkSubmitDialog",["require","exports","module","babelHelpers","bootstrapValidator","../ui/Modal","../resource","../util"],function(e,o){function a(e){var o=m.encodeData(e),a=o.workId,r=o.courseId,t=void 0===r?"":r,l=o.codeUrl,i=void 0===l?"":l,d=o.demoUrl,n=void 0===d?"":d,s=o.submitNote,u=void 0===s?"":s,v="";return null!=a&&(v='<input type="hidden" name="workId" value="'+a+'">'),'\n<form class="'+c+'">\n    '+v+'\n    <input type="hidden" name="courseId" value="'+t+'">\n    <div class="form-group">\n        <label for="work-code-url">代码地址</label>\n        <input type="text" value="'+i+'" placeholder="代码地址，比如 Github" class="form-control" id="work-code-url" name="codeUrl" required>\n    </div>\n    <div class="form-group">\n        <label for="work-demo-url">demo 地址</label>\n        <input type="text" value="'+n+'" placeholder="在线可访问 demo 地址，选填" class="form-control" id="work-demo-url" name="demoUrl">\n    </div>\n    <div class="form-group">\n        <label for="work-note">说明</label>\n        <textarea placeholder="完成的作业说明，选填" class="form-control" id="work-note" name="note">'+u+"</textarea>\n    </div>\n</form>\n"}function r(){if(this.validator.validate(),this.validator.isValid()){var e=m.toFormObject(this.$("."+c).serializeArray());return u.default.post("/course/submitWork",e).then(function(e){var o=0===+e.status;o?window.location.reload():n.default.alert(e.statusInfo||"提交失败")})}}function t(e){var o=null!=e.workId,t=new n.default({modalTitle:o?"更新提交作业":"提交作业",modalBody:a(e),modalClass:"submit-work-dlg",modalSizeClass:"modal-lg",saveBtn:o?"更新提交的作业":"完成学习提交作业",savingText:o?"更新中...":"提交中...",closeBtn:!1,onSave:r,onClose:function(){this.dispose()},clickMaskClose:!1});return t.isUpdate=o,t.validator=t.$("."+c).bootstrapValidator({live:"enabled",fields:{codeUrl:{validators:{notEmpty:{message:"代码地址不能为空"},uri:{message:"代码地址无效"}}},demoUrl:{validators:{uri:{message:"demo 地址无效"}}},note:{validators:{stringLength:{max:300,message:"说明不超过500个字"}}}}}).data("bootstrapValidator"),t}function l(e){return t(e||{})}var i=e("babelHelpers");Object.defineProperty(o,"__esModule",{value:!0}),o.default=l,e("bootstrapValidator");var d=e("../ui/Modal"),n=i.interopRequireDefault(d),s=e("../resource"),u=i.interopRequireDefault(s),m=e("../util"),c="submit-work-form"});
define("common/util",["require","exports","module","babelHelpers"],function(e,r){function n(e){var r=/[^\x00-\xff]/g;return e.replace(r,"**").length}function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...";if(n&&r>n.length&&(r-=n.length),e.length<=r)return e;var t=e.substr(0,r);return t+n}function u(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""}function a(e){if("string"==typeof e)return u(e);var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]="string"==typeof e[n]?u(e[n]):e[n]);return r}function l(e){for(var r={},n=0,t=e.length;t>n;n++)r[e[n].name]=e[n].value.trim();return r}function o(e){return e.replace(/(?:\r\n|\r|\n)/g,"<br>")}e("babelHelpers");Object.defineProperty(r,"__esModule",{value:!0}),r.getStrLen=n,r.truncateStr=t,r.encodeHTML=u,r.encodeData=a,r.toFormObject=l,r.nl2br=o});
define("common/util/url",["require","exports","module","babelHelpers","jquery"],function(e,r){function n(e){var r=e.indexOf("#");return r>=0?e.substring(0,r):e}function t(e,r,t){return t?n(e)===n(r):e===r}function o(e){if("string"!=typeof e)return e;var r=document.createElement("a");return r.href=e,r}function a(e){for(var r=e.split("&"),n={},t=0,o=r.length;o>t;t++){var a=r[t];if(a){var i=a.indexOf("="),u=decodeURIComponent(0>i?a:a.slice(0,i)),s=0>i?!0:decodeURIComponent(a.slice(i+1));n.hasOwnProperty(u)?s!==!0&&(n[u]=n[u]===!0?s:[].concat(n[u],s)):n[u]=s}}return n}function i(e){if(!e)return"";var r=[];for(var n in e)if(e.hasOwnProperty(n)){var t=e[n];void 0!==t&&r.push(encodeURIComponent(n)+"="+encodeURIComponent(t))}return r.join("&")}function u(e,r,t){var u=void 0;if(r&&Object.keys(r).length){var s=o(e),c=s.search,l=c?a(c.substr(1)):{};l=f.default.extend(l,r||{}),u=s.protocol+"//"+s.host+s.pathname;var p=i(l);u+=(p?"?":"")+p,u+=s.hash}else u=e;return t&&(u=n(u),u=u+"#"+encodeURIComponent(t)),u}var s=e("babelHelpers");Object.defineProperty(r,"__esModule",{value:!0}),r.isSameUrl=t,r.parseURL=o,r.parseQuery=a,r.serialize=i,r.updateURL=u;var c=e("jquery"),f=s.interopRequireDefault(c)});
define("common/biz/reviewApply",["require","exports","module","babelHelpers","../resource","../ui/Modal"],function(e,t){function r(e,t,r){l.default.confirm("需要扣除的积分: "+e.data("score")+"，确定兑换导师评价吗？",function(){return e.button("loading"),a.default.post("/work/applyReview",{workId:t}).then(function(t){if(0===t.status){var u=t.data;l.default.alert("申请成功，待导师评价"),e.text("申请成功，待导师评价"),r&&r(u)}else e.button("reset"),l.default.alert(t.statusInfo||"申请失败")},function(){e.button("reset")})})}var u=e("babelHelpers");Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=e("../resource"),a=u.interopRequireDefault(o),n=e("../ui/Modal"),l=u.interopRequireDefault(n)});
define("common/biz/NoteSubmitDialog",["require","exports","module","babelHelpers","bootstrapValidator","../ui/Modal","../ui/Loading","../services/note","../services/course","../util","../ui/MDEditor"],function(e,t){function o(e){var t=m.encodeData(e),o=t.id,n=t.title,a=void 0===n?"":n,r=t.courseTitle,i=t.courseId,l=void 0===i?"":i,s="";null!=o&&(s='<input type="hidden" name="noteId" value="'+o+'">');var d=l?'<input type="hidden" name="courseId" value="'+l+'">':"",u=l?" disabled":"",c=l?r:"加载中...",f='<option value="'+l+'" selected>'+c+"</option>";return'\n<form class="'+b+'">\n    '+s+"\n    "+d+'\n    <div class="form-group">\n        <label>笔记所属课程：</label>\n        <span class="ife-select-wrap">\n            <select class="course-select-field form-control" name="courseId"'+u+">\n                "+f+'\n            </select>\n        </span>\n    </div>\n    <div class="form-group">\n        <label for="note-title">标题：</label>\n        <input type="text" value="'+a+'" placeholder="笔记的标题" class="form-control" id="note-title" name="title" required>\n    </div>\n    <div class="form-group">\n        <label for="note-content">内容：</label>\n        <textarea required rows="5" class="form-control" name="contentMd" id="note-content" placeholder="请认真撰写笔记内容，否则太随意或者过于简单的笔记可能会被审核不通过，没法出现在精选笔记里哦~"></textarea>\n    </div>\n</form>\n'}function n(){var e=this;if(this.validator.validate(),this.validator.isValid()){var t=m.toFormObject(this.$("."+b).serializeArray()),o=this.mdeEditor.value();if(o.trim()&&t.courseId)return t.contentMd=o,t.contentHtml=this.mdeEditor.getRenderHtml(),f.addOrUpdateNote(t).then(function(t){if(t.hasError)d.default.alert(t.errorInfo||"提交失败");else{var o=e.onSaveDoneHandler;o?o.call(e):window.location.reload()}})}}function a(e,t,a){var r=new d.default({modalTitle:e?"更新笔记":"新增笔记",modalBody:o(t),modalClass:"note-dlg",modalSizeClass:"modal-lg",saveBtn:e?"更新笔记":"发布笔记",savingText:e?"更新中...":"发布中...",closeBtn:!1,onSave:n,onClose:function(){this.mdeEditor&&this.mdeEditor.dispose(),this.contentTextArea=null,this.dispose()},onShow:function(){var e=this;this.contentTextArea=this.$("#note-content");var o=this.mdeEditor=new h.default({element:this.contentTextArea[0]});o.addFullScreenToggleListener(function(t){e.main[t?"addClass":"removeClass"]("fullscreen")}),o.addInputChangeListener(function(){e.contentTextArea.val(o.value())}),t.contentMd&&o.value(t.contentMd)},clickMaskClose:!1});return r.isUpdate=e,r.onSaveDoneHandler=a,r.validator=r.$("."+b).bootstrapValidator({live:"enabled",fields:{title:{validators:{notEmpty:{message:"笔记标题不能为空"},stringLength:{max:100,message:"笔记标题不超过100个字"}}},contentMd:{validators:{notEmpty:{message:"笔记内容不能为空"}}}}}).data("bootstrapValidator"),r}function r(e,t){var o=null!=e.id;if(o&&!e.courseTitle){var n=new c.default(!0);return n.show(),f.fetchNoteDetail(e.id).then(function(r){return n.dispose(),r.hasError?void d.default.alert("加载笔记内容失败："+r.errorInfo):(e=r,a(o,e,t))},function(){return n.dispose()})}var r=a(o,e,t);return e.courseId||o||v.searchCourseList({onlyLearn:1,pageNo:1,pageSize:100}).then(function(e){if(!e.hasError){e.listData.length||d.default.alert("您还未有开始学习的课程，暂时不能发表笔记");var t="";e.listData.forEach(function(e,o){e=m.encodeData(e);var n=0===o?" selected":"";t+='<option value="'+e.id+'"'+n+">"+e.title+"</option>"}),r.$(".course-select-field").html(t||'<option value="" selected>没有学习的课程</option>')}}),r}function i(e,t){return r(e||{},t)}var l=e("babelHelpers");Object.defineProperty(t,"__esModule",{value:!0}),t.default=i,e("bootstrapValidator");var s=e("../ui/Modal"),d=l.interopRequireDefault(s),u=e("../ui/Loading"),c=l.interopRequireDefault(u),f=e("../services/note"),v=e("../services/course"),m=e("../util"),p=e("../ui/MDEditor"),h=l.interopRequireDefault(p),b="submit-note-form"});
define("common/services/user",["require","exports","module","babelHelpers","../resource","../biz/helper"],function(e,s){function t(e,s){return R.default.post("/user/getDoneCourses",{pageNo:e,userId:s}).then(g.processResponse)}function o(){return R.default.post("/user/getLearningCourses").then(g.processResponse)}function r(){return R.default.post("/user/getPublishCourses").then(g.processResponse)}function n(e,s){return R.default.post("/user/getNotes",{pageNo:e,userId:s}).then(g.processResponse)}function u(e){return R.default.post("/user/delNote",{noteId:e}).then(g.processResponse)}function p(e){return R.default.post("/user/delNoteComment",{commentId:e}).then(g.processResponse)}function c(e){return R.default.post("/user/getScoreRecords",{pageNo:e}).then(g.processResponse)}function f(e,s){return R.default.post("/user/getReviews",{pageNo:e,userId:s}).then(g.processResponse)}function i(e){return R.default.post("/user/getToReviewWorks",{pageNo:e}).then(g.processResponse)}function d(e){return R.default.post("/user/edit",e).then(g.processResponse)}function l(e,s){return R.default.post("/user/getToAuditNotes",{pageNo:e,pageSize:s}).then(g.processResponse)}var a=e("babelHelpers");Object.defineProperty(s,"__esModule",{value:!0}),s.fetchDoneCourses=t,s.fetchLearningCourses=o,s.fetchPublishCourses=r,s.fetchUserNotes=n,s.delUserNote=u,s.delUserNoteComment=p,s.fetchUserScoreRecords=c,s.fetchUserReviewWorks=f,s.fetchMentorNeedReviewWorks=i,s.updateUserProfile=d,s.fetchUserToAuditNotes=l;var h=e("../resource"),R=a.interopRequireDefault(h),g=e("../biz/helper")});
define("common/services/message",["require","exports","module","babelHelpers","../resource","../biz/helper"],function(e,s){function t(e){return d.default.post("/message/list",e).then(c.processResponse)}function n(){return d.default.post("/message/getUnreadMsgCount").then(c.processResponse)}function r(e){return d.default.post("/message/delete",e).then(c.processResponse)}function o(e){return d.default.post("/message/tagRead",e).then(c.processResponse)}function a(e){return d.default.post("/message/addWorkChangeMsg",e).then(c.processResponse)}var u=e("babelHelpers");Object.defineProperty(s,"__esModule",{value:!0}),s.fetchMsgList=t,s.fetchUnReadMsgCount=n,s.deleteMessage=r,s.tagMessageRead=o,s.addWorkChangeMsg=a;var p=e("../resource"),d=u.interopRequireDefault(p),c=e("../biz/helper")});
define("common/biz/eventCenter",["require","exports","module","babelHelpers","saber-emitter"],function(e,r){var t=e("babelHelpers");Object.defineProperty(r,"__esModule",{value:!0});var a=e("saber-emitter"),l=t.interopRequireDefault(a);r.default=new l.default});
define("common/ui/Loading",["require","exports","module","babelHelpers","jquery"],function(n,e){function i(n,e){var i=r.default(n),s=r.default(">."+l,i);if(s.length)return s;var d=(n[0]||n)===a||r.default.contains(n,a)?" global":"";return i.height()||(d+=" auto"),s=r.default('<div class="'+l+d+'" style="display: none"></div>'),e&&s.append('<div class="loading-mask"></div>'),s.append(p),i.append(s),s}var s=n("babelHelpers");Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(n,e){1===arguments.length&&"boolean"==typeof n&&(e=n,n=null),n||(n=a);var s=i(n,e);return{show:function(){s.show()},hide:function(){s.hide()},dispose:function(){s.remove(),n=s=null}}};var d=n("jquery"),r=s.interopRequireDefault(d),a=document.body,l="loading-wrap",p='\n    <div class="spinner-wrap">\n        <div class="spinner spinner-1"></div>\n        <div class="spinner spinner-2"></div>\n        <div class="spinner spinner-3"></div>\n        <div class="spinner spinner-4"></div>\n        <div class="spinner spinner-5"></div>\n        <div class="spinner spinner-6"></div>\n        <div class="spinner spinner-7"></div>\n        <div class="spinner spinner-8"></div>\n    </div>\n'});
define("common/services/note",["require","exports","module","babelHelpers","../resource","../biz/helper"],function(e,t){function o(e,t){return f.default.post("/note/audit",{auditStatus:t,noteId:e}).then(l.processResponse)}function n(e,t){return f.default.post("/note/elite",{noteId:e,isElite:t?1:0}).then(l.processResponse)}function s(e,t){return f.default.post("/note/approve",{noteId:e,isApprove:t?1:0}).then(l.processResponse)}function r(e,t,o){return f.default.post("/note/getComments",{noteId:e,pageNo:t,pageSize:o}).then(l.processResponse)}function p(e,t){return f.default.post("/note/addComment",{noteId:e,comment:t}).then(l.processResponse)}function u(e){return f.default.post("/note/submit",e).then(l.processResponse)}function i(e){return f.default.post("/note/getList",e).then(l.processResponse)}function a(e){return f.default.post("/note/getDetail",{noteId:e}).then(l.processResponse)}var d=e("babelHelpers");Object.defineProperty(t,"__esModule",{value:!0}),t.auditNote=o,t.eliteNote=n,t.approveNote=s,t.fetchNoteComments=r,t.addNoteComment=p,t.addOrUpdateNote=u,t.fetchNoteList=i,t.fetchNoteDetail=a;var c=e("../resource"),f=d.interopRequireDefault(c),l=e("../biz/helper")});
define("common/services/course",["require","exports","module","babelHelpers","../resource","../biz/helper"],function(e,r){function s(e){return c.default.post("/course/search",e).then(t.processResponse)}var o=e("babelHelpers");Object.defineProperty(r,"__esModule",{value:!0}),r.searchCourseList=s;var u=e("../resource"),c=o.interopRequireDefault(u),t=e("../biz/helper")});
define("common/ui/MDEditor",["require","exports","module","babelHelpers","highlight.js","jquery","marked","simplemde"],function(e,t){function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n.default.extend(d.default.defaults,{sanitize:!0},t);var a=new c.default(n.default.extend({spellChecker:!1,status:!1,autoDownloadFontAwesome:!1,renderingConfig:{codeSyntaxHighlighting:!0},toolbar:[{name:"bold",action:c.default.toggleBold,className:"icon-bold",title:"加粗"},{name:"italic",action:c.default.toggleItalic,className:"icon-italic",title:"斜体"},{name:"heading",action:c.default.toggleHeadingSmaller,className:"icon-header",title:"标题"},"|",{name:"quote",action:c.default.toggleBlockquote,className:"icon-quote-left",title:"插入引用"},{name:"unordered-list",action:c.default.toggleUnorderedList,className:"icon-ul",title:"插入无序列表"},{name:"ordered-list",action:c.default.toggleOrderedList,className:"icon-ol",title:"插入有序列表"},"|",{name:"link",action:c.default.drawLink,className:"icon-link",title:"插入链接"},{name:"image",action:c.default.drawImage,className:"icon-picture",title:"插入图片"},{name:"code",action:c.default.drawTable,className:"icon-table",title:"插入表格"},{name:"table",action:c.default.toggleCodeBlock,className:"icon-code",title:"插入代码片段"},"|",{name:"preview",action:c.default.togglePreview,className:"icon-view no-disable",title:"预览"},{name:"side-by-side",action:c.default.toggleSideBySide,className:"icon-columns no-disable no-mobile",title:"两栏模式"},{name:"fullscreen",action:c.default.toggleFullScreen,className:"icon-fullscreen no-disable no-mobile",title:"全屏"},"|",{name:"guide",action:"https://simplemde.com/markdown-guide",className:"icon-question",title:"Markdown 语法查看"}]},e||{})),i=new d.default.Renderer;i.table=function(e,t){return'<table class="table table-bordered table-hover">'+e+t+"</table>"};var l=c.default.prototype.markdown;return a.markdown=function(e){return this.initedMarkdown||(l.call(this,""),this.initedMarkdown=!0),d.default(e,{renderer:i})},a.getRenderHtml=function(){return this.markdown(this.value())},a.addInputChangeListener=function(e){this.codemirror.on("change",e.bind(this))},a.addFullScreenToggleListener=function(e){var t=this;a.codemirror.on("optionChange",function(i,l){"fullScreen"===l&&e.call(t,a.codemirror.getOption(l))})},a.dispose||(a.dispose=function(){this.toTextArea()}),a}var i=e("babelHelpers");Object.defineProperty(t,"__esModule",{value:!0}),t.default=a,e("highlight.js");var l=e("jquery"),n=i.interopRequireDefault(l),o=e("marked"),d=i.interopRequireDefault(o),r=e("simplemde"),c=i.interopRequireDefault(r)});
define("common/biz/helper",["require","exports","module","babelHelpers"],function(e,t){function a(e){return 0!==e.status?{hasError:!0,errorInfo:e.statusInfo}:(e.data&&e.data.total&&(e.data.total=+e.data.total),e.data||{})}function r(e){var t={1:1,2:2,3:2,4:3},a=0;return e%2&&(a=t[Math.floor(e/2)]||0),e/10*100+a}e("babelHelpers");Object.defineProperty(t,"__esModule",{value:!0}),t.processResponse=a,t.getReviewScoreValue=r});
!function(e,n){"function"==typeof define&&define.amd?define("babelHelpers",["exports"],n):n("object"==typeof exports?exports:e.babelHelpers={})}(this,function(e){var n=e;n.classCallCheck=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},n.createClass=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}(),n.defineProperty=function(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e},n.interopRequireDefault=function(e){return e&&e.__esModule?e:{"default":e}}});
